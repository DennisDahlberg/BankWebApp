@page
@model BankWebApp.Pages.Customers.Accounts.SelectAccountModel
@{
}

<section id="hero" class="hero section dark-background">

    <img class="backgroundImage" src="~/assets/img/hero-bg.jpg" alt="" data-aos="fade-in">

    <div class="container mt-3">


        <div class="container section-title mb-0" data-aos="fade-down">
            <span class="description-title">Select an account</span>
            <h2>Select an account</h2>
        </div>

        <div class="text-center">
            <a class="btn btn-secondary"
               asp-route-customerId="@Model.CustomerId"
               asp-route-accountId="@Model.AccountId"
               asp-route-showContent="customer">
               Own accounts
            </a>

            <a class="btn btn-secondary"
                asp-route-customerId="@Model.CustomerId"
                asp-route-accountId="@Model.AccountId"
                asp-route-showContent="all">
                All accounts
            </a>
        </div>

        @if (Model.ShowContent == "all")
        {
            <div>
                <div class="container mb-1 d-flex gap-4 align-items-center">
                    <form method="get">
                        <div class="search-box">
                            <button type="submit" class="btn-search"><i class="fas fa-search"></i></button>
                            <input asp-for="@Model.Q" type="text" class="input-search" placeholder="Type to Search...">
                            <input type="hidden" asp-for="@Model.ShowContent"/>
                            <input type="hidden" asp-for="@Model.CustomerId" />
                            <input type="hidden" asp-for="@Model.AccountId" />
                        </div>
                    </form>
                    <a 
                        asp-page="/Customers/Details"
                        asp-route-id="@Model.CustomerId"
                        class="btn btn-secondary">
                        <i class="fa-regular fa-circle-left"></i>
                        Back
                    </a>
                </div>                


                <div class="table-responsive">

                    <table class="table custom-table">
                        <thead>
                            <tr>


                                <th scope="col">
                                    AccountId
                                    <a asp-page="/Customers/Accounts/SelectAccount"
                                       asp-route-sortBy="Id"
                                       asp-route-sortOrder="asc"
                                       asp-route-showContent="all"
                                       asp-route-customerId="@Model.CustomerId"
                                       asp-route-accountId="@Model.AccountId"
                                       asp-route-q="@Model.Q">
                                        <i class="fa-solid fa-angle-up"></i>
                                    </a>
                                    <a asp-page="/Customers/Accounts/SelectAccount"
                                       asp-route-sortBy="Id"
                                       asp-route-sortOrder="desc"
                                       asp-route-showContent="all"
                                       asp-route-customerId="@Model.CustomerId"
                                       asp-route-accountId="@Model.AccountId"
                                       asp-route-q="@Model.Q">
                                        <i class="fa-solid fa-angle-down"></i>
                                    </a>
                                </th>
                                <th scope="col">
                                    Name
                                    <a asp-page="/Customers/Accounts/SelectAccount"
                                       asp-route-sortBy="Name"
                                       asp-route-showContent="all"
                                       asp-route-customerId="@Model.CustomerId"
                                       asp-route-accountId="@Model.AccountId"
                                       asp-route-q="@Model.Q"
                                       asp-route-sortOrder="asc">
                                        <i class="fa-solid fa-angle-up"></i>
                                    </a>
                                    <a asp-page="/Customers/Accounts/SelectAccount"
                                       asp-route-sortBy="Name"
                                       asp-route-showContent="all"
                                       asp-route-customerId="@Model.CustomerId"
                                       asp-route-accountId="@Model.AccountId"
                                       asp-route-q="@Model.Q"
                                       asp-route-sortOrder="desc">
                                        <i class="fa-solid fa-angle-down"></i>
                                    </a>
                                </th>
                                <th scope="col">
                                    Balance
                                    <a asp-page="/Customers/Accounts/SelectAccount"
                                       asp-route-sortBy="Balance"
                                       asp-route-q="@Model.Q"
                                       asp-route-showContent="all"
                                       asp-route-customerId="@Model.CustomerId"
                                       asp-route-accountId="@Model.AccountId"
                                       asp-route-sortOrder="asc">
                                        <i class="fa-solid fa-angle-up"></i>
                                    </a>
                                    <a asp-page="/Customers/Accounts/SelectAccount"
                                       asp-route-sortBy="Balance"
                                       asp-route-q="@Model.Q"
                                       asp-route-showContent="all"
                                       asp-route-customerId="@Model.CustomerId"
                                       asp-route-accountId="@Model.AccountId"
                                       asp-route-sortOrder="desc">
                                        <i class="fa-solid fa-angle-down"></i>
                                    </a>
                                </th>

                                <th scope="col">
                                    
                                </th>


                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var account in Model.AllAccounts)
                            {
                                <tr>
                                    <td>@account.AccountId</td>
                                    <td><a>@account.Givenname @account.Surname</a></td>
                                    <td>@account.Balance</td>
                                    <td>
                                        <a 
                                            class="more btn" 
                                            asp-page="/Customers/Accounts/Transfer" 
                                            asp-route-accountIdFrom="@Model.AccountId"
                                            asp-route-customerId="@Model.CustomerId"
                                            asp-route-accountIdTo="@account.AccountId">
                                            Transfer
                                        </a>
                                    </td>
                                </tr>
                            }

                            <tr class="text-center table-links">
                                <td colspan="6">
                                    @if (Model.CurrentPage != 1)
                                    {
                                        <a asp-page="/Customers/Accounts/SelectAccount"
                                           asp-route-sortOrder="@Model.SortOrder"
                                           asp-route-sortBy="@Model.SortBy"
                                           asp-route-q="@Model.Q"
                                           asp-route-showContent="all"
                                           asp-route-customerId="@Model.CustomerId"
                                           asp-route-accountId="@Model.AccountId"
                                           asp-route-pageNo="@(Model.CurrentPage - 1)"
                                           class="btn btn-success">
                                            Prev
                                        </a>
                                    }

                                    @for (int i = Math.Max(1, Model.CurrentPage - 3); i <= Math.Min(Model.PageCount, Model.CurrentPage + 3); i++)
                                    {
                                        <a asp-page="/Customers/Accounts/SelectAccount"
                                           asp-route-sortOrder="@Model.SortOrder"
                                           asp-route-sortBy="@Model.SortBy"
                                           asp-route-showContent="all"
                                           asp-route-customerId="@Model.CustomerId"
                                           asp-route-accountId="@Model.AccountId"
                                           asp-route-q="@Model.Q"
                                           asp-route-pageNo="@i"
                                           class="btn @(Model.CurrentPage == i ? "btn-success" : "btn-secondary")">
                                            @i
                                        </a>
                                    }

                                    @if (Model.CurrentPage != Model.PageCount)
                                    {
                                        <a asp-page="/Customers/Accounts/SelectAccount"
                                           asp-route-sortOrder="@Model.SortOrder"
                                           asp-route-q="@Model.Q"
                                           asp-route-showContent="all"
                                           asp-route-customerId="@Model.CustomerId"
                                           asp-route-accountId="@Model.AccountId"
                                           asp-route-sortBy="@Model.SortBy"
                                           asp-route-pageNo="@(Model.CurrentPage + 1)"
                                           class="btn btn-success">
                                            Next
                                        </a>
                                    }

                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        }
        else
        {
            <div class="mt-3">
                <a asp-page="/Customers/Details"
                   asp-route-id="@Model.CustomerId"
                   class="btn btn-secondary mb-2">
                    <i class="fa-regular fa-circle-left"></i>
                    Back
                </a>

                <div class="table-responsive">

                    <table class="table custom-table">
                        <thead>
                            <tr>
                                <th scope="col">AccountId</th>
                                <th scope="col">Name</th>
                                <th scope="col">Balance</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var account in Model.CustomerAccounts)
                            {
                                <tr>
                                    <td>@account.AccountId</td>
                                    <td><a>@account.Givenname @account.Surname</a></td>
                                    <td>@account.Balance</td>
                                    <td>
                                        <a class="more btn"
                                           asp-page="/Customers/Accounts/Transfer"
                                           asp-route-accountIdFrom="@Model.AccountId"
                                           asp-route-customerId="@Model.CustomerId"
                                           asp-route-accountIdTo="@account.AccountId">
                                            Transfer
                                        </a>
                                    </td>
                                </tr>
                            }                            
                        </tbody>
                    </table>
                </div>
            </div>
        }
        

        


    </div>









</section>